
*& Report  ZPRATAP_INTERNAL_TABLE_07
*&
*&---------------------------------------------------------------------*
*&  Internal table with local structure
*&
*&---------------------------------------------------------------------*

REPORT  ZPRATAP_INTERNAL_TABLE_07.

TABLES:KNA1,VBAK.

TYPES: BEGIN OF TY_VBAK,
       VBELN TYPE VBELN_VA,
       AUDAT TYPE AUDAT,
       NETWR TYPE NETWR_AK,
       KUNNR TYPE  KUNAG,
       END OF TY_VBAK.

TYPES: BEGIN OF TY_KNA1,
       KUNNR TYPE KUNAG,
       LAND1 TYPE LAND1_GP,
       NAME1 TYPE NAME1_GP,
       NAME2 TYPE NAME2_GP,
       END OF TY_KNA1.

TYPES: BEGIN OF TY_VBAP,
       VBELN TYPE VBELN_VA,
       POSNR TYPE POSNR_VA,
       MATNR TYPE MATNR,
       END OF TY_VBAP.

DATA: IT_VBAK TYPE TABLE OF TY_VBAK,
      WA_VBAK TYPE TY_VBAK,
      WA_KNA1 TYPE TY_KNA1,
      IT_VBAP TYPE TABLE OF TY_VBAP.

SELECTION-SCREEN BEGIN OF  BLOCK B1 WITH FRAME TITLE SSO1.
SELECT-OPTIONS S_KUNNR FOR KNA1-KUNNR.
SELECT-OPTIONS S_VBELN FOR WA_VBAK-VBELN.
SELECTION-SCREEN END OF BLOCK B1.

INITIALIZATION.

  CLEAR:WA_VBAK,WA_KNA1.
  REFRESH:IT_VBAK.

AT SELECTION-SCREEN.

  SELECT SINGLE KUNNR FROM KNA1 INTO WA_KNA1-KUNNR
     WHERE KUNNR IN S_KUNNR.

  IF SY-SUBRC <> 0.
    MESSAGE 'Invalid customer' TYPE 'E'.
  ENDIF.

START-OF-SELECTION.

  SELECT SINGLE KUNNR LAND1 NAME1 NAME2 FROM KNA1 INTO WA_KNA1 WHERE KUNNR IN S_KUNNR.

  SELECT VBELN AUDAT NETWR KUNNR FROM VBAK INTO TABLE IT_VBAK
         WHERE KUNNR IN S_KUNNR
         AND VBELN IN S_VBELN.


  LOOP AT IT_VBAK INTO WA_VBAK.

    WRITE:/ WA_KNA1-KUNNR, WA_KNA1-LAND1, WA_KNA1-NAME1, WA_KNA1-NAME2, WA_VBAK-VBELN,WA_VBAK-AUDAT,WA_VBAK-NETWR.
  ENDLOOP.